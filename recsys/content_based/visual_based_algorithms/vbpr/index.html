
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../content_based_algorithms/index_query/">
      
      
        <link rel="next" href="../../../graph_based/graph_based_recsys/">
      
      <link rel="icon" href="../../../../images/icon_no_borders.svg">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.15">
    
    
      
        <title>VBPR - ClayRS documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.113286f1.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#centroid-vector" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="ClayRS documentation" class="md-header__button md-logo" aria-label="ClayRS documentation" data-md-component="logo">
      
  <img src="../../../../images/icon_no_borders.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ClayRS documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              VBPR
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/swapUniba/ClayRS" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    swapUniba/ClayRS
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../first_steps/installation/" class="md-tabs__link">
        First steps
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../content_analyzer/introduction/" class="md-tabs__link">
        Content Analyzer
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../introduction/" class="md-tabs__link md-tabs__link--active">
        Recsys
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../evaluation/introduction/" class="md-tabs__link">
        Evaluation
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../utils/report/" class="md-tabs__link">
        Utils
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="ClayRS documentation" class="md-nav__button md-logo" aria-label="ClayRS documentation" data-md-component="logo">
      
  <img src="../../../../images/icon_no_borders.svg" alt="logo">

    </a>
    ClayRS documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/swapUniba/ClayRS" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    swapUniba/ClayRS
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          First steps
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          First steps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../first_steps/installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../first_steps/quickstart/" class="md-nav__link">
        Quickstart
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../first_steps/colab_examples/" class="md-nav__link">
        Colab examples
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Content Analyzer
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Content Analyzer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/config/" class="md-nav__link">
        Content Analyzer config and class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/raw_sources/" class="md-nav__link">
        Raw source wrappers
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
      
      
      
        <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Ratings
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Ratings
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/ratings/ratings/" class="md-nav__link">
        Ratings class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/ratings/score_processors/" class="md-nav__link">
        Score processors
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
      
      
      
        <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
          Information Processors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          Information Processors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_5_1" id="__nav_3_5_1_label" tabindex="0">
          Preprocessors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_5_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5_1">
          <span class="md-nav__icon md-icon"></span>
          Preprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_1_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_5_1_1" id="__nav_3_5_1_1_label" tabindex="0">
          Textual preprocessors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_5_1_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5_1_1">
          <span class="md-nav__icon md-icon"></span>
          Textual preprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/information_preprocessors/textual_preprocessors/nltk/" class="md-nav__link">
        NLTK
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/information_preprocessors/textual_preprocessors/spacy/" class="md-nav__link">
        Spacy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/information_preprocessors/textual_preprocessors/ekphrasis/" class="md-nav__link">
        Ekphrasis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_1_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_5_1_2" id="__nav_3_5_1_2_label" tabindex="0">
          Visual preprocessors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_5_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5_1_2">
          <span class="md-nav__icon md-icon"></span>
          Visual preprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/information_preprocessors/visual_preprocessors/torch_preprocessors/" class="md-nav__link">
        Torch preprocessors
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/information_preprocessors/postprocessors/postprocessor/" class="md-nav__link">
        Postprocessors
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
      
      
      
        <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
          Content Techniques
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          Content Techniques
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_6_1" id="__nav_3_6_1_label" tabindex="0">
          Textual techniques
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6_1">
          <span class="md-nav__icon md-icon"></span>
          Textual techniques
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_1_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_6_1_1" id="__nav_3_6_1_1_label" tabindex="0">
          Embedding techniques
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_6_1_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6_1_1">
          <span class="md-nav__icon md-icon"></span>
          Embedding techniques
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/content_techniques/textual_techniques/embedding_techniques/word_embeddings/" class="md-nav__link">
        Word Embeddings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/content_techniques/textual_techniques/embedding_techniques/sentence_embeddings/" class="md-nav__link">
        Sentence Embeddings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/content_techniques/textual_techniques/embedding_techniques/document_embeddings/" class="md-nav__link">
        Document Embeddings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/content_techniques/textual_techniques/embedding_techniques/combining_embeddings/" class="md-nav__link">
        Combining Embeddings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/content_techniques/textual_techniques/embedding_techniques/contextualized_embeddings/" class="md-nav__link">
        Contextualized Embeddings
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/content_techniques/textual_techniques/tfidf/" class="md-nav__link">
        TfIdf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/content_techniques/textual_techniques/original_data/" class="md-nav__link">
        Original Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/content_techniques/textual_techniques/synset_df_frequency/" class="md-nav__link">
        Synset Document Frequency
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_6_2" id="__nav_3_6_2_label" tabindex="0">
          Visual techniques
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6_2">
          <span class="md-nav__icon md-icon"></span>
          Visual techniques
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/content_techniques/visual_techniques/low_level_visual/" class="md-nav__link">
        Low level techniques
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/content_techniques/visual_techniques/high_level_visual/" class="md-nav__link">
        High level techniques
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/content_techniques/from_npy/" class="md-nav__link">
        Import from NPY
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
      
      
      
        <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
          Exogenous Techniques
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_7">
          <span class="md-nav__icon md-icon"></span>
          Exogenous Techniques
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/exogenous_techniques/dbpedia/" class="md-nav__link">
        DBPedia Mapping
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/exogenous_techniques/properties_from_dataset/" class="md-nav__link">
        Properties From Dataset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/exogenous_techniques/babelfy/" class="md-nav__link">
        BabelFy Entity Linking
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
      
      
      
        <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
          Memory Interfaces
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_8">
          <span class="md-nav__icon md-icon"></span>
          Memory Interfaces
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../content_analyzer/index_interface/" class="md-nav__link">
        Index Interface
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Recsys
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Recsys
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          Partitioning techniques
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Partitioning techniques
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../partitioning/abstract_partitioning/" class="md-nav__link">
        Abstract Partitioning class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../partitioning/hold_out/" class="md-nav__link">
        Hold Out
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../partitioning/kfold/" class="md-nav__link">
        KFold
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../partitioning/bootstrap/" class="md-nav__link">
        Bootstrap
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
          Content Based recommendation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Content Based recommendation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../content_based_recsys/" class="md-nav__link">
        Content Based recsys
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_3_2" id="__nav_4_3_2_label" tabindex="0">
          Content Based algorithms
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_3_2">
          <span class="md-nav__icon md-icon"></span>
          Content Based algorithms
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../content_based_algorithms/centroid_vector/" class="md-nav__link">
        Centroid Vector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../content_based_algorithms/classifier_recommender/" class="md-nav__link">
        Classifier Recommender
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../content_based_algorithms/linear_predictor/" class="md-nav__link">
        Linear Predictor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../content_based_algorithms/index_query/" class="md-nav__link">
        Index Query
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4_3_3" id="__nav_4_3_3_label" tabindex="0">
          Visual Based algorithms
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4_3_3">
          <span class="md-nav__icon md-icon"></span>
          Visual Based algorithms
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          VBPR
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        VBPR
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR" class="md-nav__link">
    VBPR
  </a>
  
    <nav class="md-nav" aria-label="VBPR">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.fit_predict" class="md-nav__link">
    fit_predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.fit_rank" class="md-nav__link">
    fit_rank()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.rank" class="md-nav__link">
    rank()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
          Graph based recommendation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Graph based recommendation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graph_based/graph_based_recsys/" class="md-nav__link">
        Graph Based recsys
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_4_2" id="__nav_4_4_2_label" tabindex="0">
          Graphs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_4_2">
          <span class="md-nav__icon md-icon"></span>
          Graphs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graph_based/graphs/nodes/" class="md-nav__link">
        Nodes categories
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graph_based/graphs/nx_bipartite/" class="md-nav__link">
        Bipartite Graph
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graph_based/graphs/nx_tripartite/" class="md-nav__link">
        Tripartite Graph
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graph_based/graphs/nx_full/" class="md-nav__link">
        Full Graph
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_3" >
      
      
      
        <label class="md-nav__link" for="__nav_4_4_3" id="__nav_4_4_3_label" tabindex="0">
          Graph Based algorithms
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_4_3">
          <span class="md-nav__icon md-icon"></span>
          Graph Based algorithms
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graph_based/graph_based_algorithms/nx_pagerank/" class="md-nav__link">
        Page Rank
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graph_based/feature_selection/" class="md-nav__link">
        Feature Selection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
      
      
      
        <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
          Experiment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          Experiment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../experiment/" class="md-nav__link">
        Experiment class
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
      
      
      
        <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
          Methodologies
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          Methodologies
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../methodology/abstract_methodology/" class="md-nav__link">
        Abstract Methodology class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../methodology/test_ratings/" class="md-nav__link">
        TestRatings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../methodology/test_items/" class="md-nav__link">
        TestItems
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../methodology/training_items/" class="md-nav__link">
        TrainingItems
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../methodology/all_items/" class="md-nav__link">
        AllItems
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Evaluation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Evaluation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../evaluation/introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../evaluation/eval_model/" class="md-nav__link">
        EvalModel class
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
      
      
      
        <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
          Metrics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Metrics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../evaluation/metrics/classification_metrics/" class="md-nav__link">
        Classification metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../evaluation/metrics/ranking_metrics/" class="md-nav__link">
        Ranking metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../evaluation/metrics/error_metrics/" class="md-nav__link">
        Error metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../evaluation/metrics/fairness_metrics/" class="md-nav__link">
        Fairness metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../evaluation/metrics/plot_metrics/" class="md-nav__link">
        Plot metrics
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
      
      
      
        <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
          Statistical tests
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_4">
          <span class="md-nav__icon md-icon"></span>
          Statistical tests
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../evaluation/statistical_tests/paired/" class="md-nav__link">
        Paired
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Utils
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../utils/report/" class="md-nav__link">
        Report
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR" class="md-nav__link">
    VBPR
  </a>
  
    <nav class="md-nav" aria-label="VBPR">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.fit_predict" class="md-nav__link">
    fit_predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.fit_rank" class="md-nav__link">
    fit_rank()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.rank" class="md-nav__link">
    rank()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="centroid-vector">Centroid Vector</h1>


<div class="doc doc-object doc-class">



<h2 id="clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR" class="doc doc-heading">
<code class="highlight language-python"><span class="n">VBPR</span><span class="p">(</span><span class="n">item_field</span><span class="p">,</span> <span class="n">gamma_dim</span><span class="p">,</span> <span class="n">theta_dim</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">lambda_w</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">lambda_b_pos</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">lambda_b_neg</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">lambda_e</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">train_loss</span><span class="o">=</span><span class="n">fun</span><span class="o">.</span><span class="n">logsigmoid</span><span class="p">,</span> <span class="n">optimizer_class</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">embedding_combiner</span><span class="o">=</span><span class="n">Centroid</span><span class="p">(),</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">additional_opt_parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">additional_dl_parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="clayrs.recsys.content_based_algorithm.content_based_algorithm.ContentBasedAlgorithm">ContentBasedAlgorithm</span></code></p>

  
      <p>Class that implements recommendation through the VBPR algorithm.
It's a ranking algorithm, so it can't do score prediction.</p>
<p>The VBPR algorithm expects features extracted from images and works on implicit feedback, but in theory you could
use any embedding representation, and you can use explicit feedback which will be converted into implicit one
thanks to the <code>threshold</code> parameter:</p>
<ul>
<li>All scores <span class="arithmatex">\(&gt;= threshold\)</span> are considered positive scores</li>
</ul>
<p>For more details on VBPR algorithm, please check the relative paper
<a href="https://cseweb.ucsd.edu/~jmcauley/pdfs/aaai16.pdf">here</a></p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>item_field</code></td>
          <td class="doc-param-details">
            <p>dict where the key is the name of the field
that contains the content to use, value is the representation(s) id(s) that will be
used for the said item. The value of a field can be a string or a list,
use a list if you want to use multiple representations for a particular field.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>gamma_dim</code></td>
          <td class="doc-param-details">
            <p>dimension of latent factors for non-visual parameters</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>theta_dim</code></td>
          <td class="doc-param-details">
            <p>dimension of latent factors for visual parameters</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>batch_size</code></td>
          <td class="doc-param-details">
            <p>dimension of each batch of the torch dataloader for the images features</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>epochs</code></td>
          <td class="doc-param-details">
            <p>number of training epochs</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td class="doc-param-details">
            <p>float value which is used to distinguish positive from negative items. If None, it will vary for each
user, and it will be set to the average rating given by it</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>0</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>learning_rate</code></td>
          <td class="doc-param-details">
            <p>learning rate for the torch optimizer</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>0.005</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>lambda_w</code></td>
          <td class="doc-param-details">
            <p>weight assigned to the regularization of the loss on <span class="arithmatex">\(\gamma_u\)</span>, <span class="arithmatex">\(\gamma_i\)</span>, <span class="arithmatex">\(\theta_u\)</span></p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>0.01</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>lambda_b_pos</code></td>
          <td class="doc-param-details">
            <p>weight assigned to the regularization of the loss on <span class="arithmatex">\(\beta_i\)</span> for the positive items</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>0.01</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>lambda_b_neg</code></td>
          <td class="doc-param-details">
            <p>weight assigned to the regularization of the loss on <span class="arithmatex">\(\beta_i\)</span> for the negative items</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>0.001</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>lambda_e</code></td>
          <td class="doc-param-details">
            <p>weight assigned to the regularization of the loss on <span class="arithmatex">\(\beta'\)</span>, <span class="arithmatex">\(E\)</span></p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>0</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>train_loss</code></td>
          <td class="doc-param-details">
            <p>loss function for the training phase. Default is logsigmoid</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[torch.<span title="torch.Tensor">Tensor</span>], torch.<span title="torch.Tensor">Tensor</span>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>fun.logsigmoid</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>optimizer_class</code></td>
          <td class="doc-param-details">
            <p>optimizer torch class for the training phase. It will be instantiated using
<code>additional_opt_parameters</code> if specified</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="typing.Type" href="https://docs.python.org/3/library/typing.html#typing.Type">Type</a>[torch.<span title="torch.optim">optim</span>.<span title="torch.optim.Optimizer">Optimizer</span>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>torch.optim.Adam</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>device</code></td>
          <td class="doc-param-details">
            <p>device on which the training will be run. If None and a GPU is available, then the GPU is automatically
selected as device to use. Otherwise, the cpu is used</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>embedding_combiner</code></td>
          <td class="doc-param-details">
            <p><code>CombiningTechnique</code> used when embeddings representation must be used, but they are in a
matrix form instead of a single vector (e.g. WordEmbedding representations have one
vector for each word). By default, the <code>Centroid</code> of the rows of the matrix is computed</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="clayrs.content_analyzer.field_content_production_techniques.embedding_technique.combining_technique.CombiningTechnique">CombiningTechnique</span></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>Centroid()</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>normalize</code></td>
          <td class="doc-param-details">
            <p>Whether to normalize input features or not. If True, the <em>input feature matrix</em> is subtracted to its
<span class="arithmatex">\(min\)</span> and divided by its <span class="arithmatex">\(max + 1e-10\)</span></p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td class="doc-param-details">
            <p>random state which will be used for weight initialization and sampling of the negative example</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>additional_opt_parameters</code></td>
          <td class="doc-param-details">
            <p>kwargs for the optimizer. If you specify <em>learning rate</em> in this parameter, it will
be overwritten by the local <code>learning_rate</code> parameter</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>additional_dl_parameters</code></td>
          <td class="doc-param-details">
            <p>kwargs for the dataloader. If you specify <em>batch size</em> in this parameter, it will
be overwritten by the local <code>batch_size</code> parameter</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>clayrs/recsys/visual_based_algorithm/vbpr/vbpr_algorithm.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_field</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
             <span class="n">gamma_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">theta_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">epochs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
             <span class="n">learning_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">,</span>
             <span class="n">lambda_w</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">lambda_b_pos</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">lambda_b_neg</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">lambda_e</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
             <span class="n">train_loss</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="n">fun</span><span class="o">.</span><span class="n">logsigmoid</span><span class="p">,</span>
             <span class="n">optimizer_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">,</span>
             <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">embedding_combiner</span><span class="p">:</span> <span class="n">CombiningTechnique</span> <span class="o">=</span> <span class="n">Centroid</span><span class="p">(),</span>
             <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">additional_opt_parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">additional_dl_parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">item_field</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">additional_opt_parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">additional_opt_parameters</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">additional_dl_parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">additional_dl_parameters</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">additional_opt_parameters</span><span class="p">[</span><span class="s2">&quot;lr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">learning_rate</span>
    <span class="n">additional_dl_parameters</span><span class="p">[</span><span class="s2">&quot;batch_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">batch_size</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span> <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;cuda:0&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_dim</span> <span class="o">=</span> <span class="n">gamma_dim</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">theta_dim</span> <span class="o">=</span> <span class="n">theta_dim</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="n">epochs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">train_loss</span> <span class="o">=</span> <span class="n">train_loss</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">train_optimizer</span> <span class="o">=</span> <span class="n">optimizer_class</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">train_optimizer_parameters</span> <span class="o">=</span> <span class="n">additional_opt_parameters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="n">normalize</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lambda_w</span> <span class="o">=</span> <span class="n">lambda_w</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lambda_b_pos</span> <span class="o">=</span> <span class="n">lambda_b_pos</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lambda_b_neg</span> <span class="o">=</span> <span class="n">lambda_b_neg</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lambda_e</span> <span class="o">=</span> <span class="n">lambda_e</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_embedding_combiner</span> <span class="o">=</span> <span class="n">embedding_combiner</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dl_parameters</span> <span class="o">=</span> <span class="n">additional_dl_parameters</span>
</code></pre></div></td></tr></table></div>
          </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.fit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">items_directory</span><span class="p">,</span> <span class="n">num_cpus</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Method which will fit the VBPR algorithm via neural training with torch</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>train_set</code></td>
          <td class="doc-param-details">
            <p><code>Ratings</code> object which contains the train set of each user</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="clayrs.content_analyzer.ratings_manager.ratings.Ratings" href="../../../../content_analyzer/ratings/ratings/#clayrs.content_analyzer.ratings_manager.Ratings">Ratings</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>items_directory</code></td>
          <td class="doc-param-details">
            <p>Path where complexly represented items are serialized by the Content Analyzer</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>num_cpus</code></td>
          <td class="doc-param-details">
            <p>number of processors that must be reserved for the method. If set to <code>0</code>, all cpus available will
be used. Be careful though: multiprocessing in python has a substantial memory overhead!</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>-1</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><span title="clayrs.recsys.visual_based_algorithm.vbpr.vbpr_network.VBPRNetwork">VBPRNetwork</span></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A fit VBPRNetwork object (torch module which implements the VBPR neural network)</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>clayrs/recsys/visual_based_algorithm/vbpr/vbpr_algorithm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_set</span><span class="p">:</span> <span class="n">Ratings</span><span class="p">,</span> <span class="n">items_directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">num_cpus</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VBPRNetwork</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method which will fit the VBPR algorithm via neural training with torch</span>

<span class="sd">    Args:</span>
<span class="sd">        train_set: `Ratings` object which contains the train set of each user</span>
<span class="sd">        items_directory: Path where complexly represented items are serialized by the Content Analyzer</span>
<span class="sd">        num_cpus: number of processors that must be reserved for the method. If set to `0`, all cpus available will</span>
<span class="sd">            be used. Be careful though: multiprocessing in python has a substantial memory overhead!</span>

<span class="sd">    Returns:</span>
<span class="sd">        A fit VBPRNetwork object (torch module which implements the VBPR neural network)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_l2_loss</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">):</span>
        <span class="n">l2_loss</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">tensor</span> <span class="ow">in</span> <span class="n">tensors</span><span class="p">:</span>
            <span class="n">l2_loss</span> <span class="o">+=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">l2_loss</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">train_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_only_positive_ratings</span><span class="p">(</span><span class="n">train_set</span><span class="p">)</span>

    <span class="n">items_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_items_features</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">items_directory</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_seed_all</span><span class="p">()</span>

    <span class="n">items_features</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">items_features</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">VBPRNetwork</span><span class="p">(</span><span class="n">n_users</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">train_set</span><span class="o">.</span><span class="n">user_map</span><span class="p">),</span>
                        <span class="n">n_items</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">train_set</span><span class="o">.</span><span class="n">item_map</span><span class="p">),</span>
                        <span class="n">features_dim</span><span class="o">=</span><span class="n">items_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">gamma_dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_dim</span><span class="p">,</span>
                        <span class="n">theta_dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">theta_dim</span><span class="p">,</span>
                        <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

    <span class="n">optimizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_optimizer</span><span class="p">([</span>
        <span class="n">model</span><span class="o">.</span><span class="n">beta_items</span><span class="p">,</span>
        <span class="n">model</span><span class="o">.</span><span class="n">gamma_users</span><span class="p">,</span>
        <span class="n">model</span><span class="o">.</span><span class="n">gamma_items</span><span class="p">,</span>
        <span class="n">model</span><span class="o">.</span><span class="n">theta_users</span><span class="p">,</span>
        <span class="n">model</span><span class="o">.</span><span class="n">E</span><span class="p">,</span>
        <span class="n">model</span><span class="o">.</span><span class="n">beta_prime</span>
    <span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">train_optimizer_parameters</span><span class="p">)</span>

    <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">TriplesDataset</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>

    <span class="n">train_dl</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">dl_parameters</span><span class="p">)</span>

    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting VBPR training!&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="p">):</span>

        <span class="n">train_loss</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">n_user_processed</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">with</span> <span class="n">get_progbar</span><span class="p">(</span><span class="n">train_dl</span><span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>

            <span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting </span><span class="si">{</span><span class="n">epoch</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="si">}</span><span class="s2"> epoch...&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pbar</span><span class="p">):</span>

                <span class="n">user_idx</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">long</span><span class="p">()</span>
                <span class="n">pos_idx</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">long</span><span class="p">()</span>
                <span class="n">neg_idx</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">long</span><span class="p">()</span>

                <span class="n">n_user_processed</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">user_idx</span><span class="p">)</span>

                <span class="n">positive_features</span> <span class="o">=</span> <span class="n">items_features</span><span class="p">[</span><span class="n">pos_idx</span><span class="p">]</span>
                <span class="n">negative_features</span> <span class="o">=</span> <span class="n">items_features</span><span class="p">[</span><span class="n">neg_idx</span><span class="p">]</span>

                <span class="n">model_input</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">user_idx</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                    <span class="n">pos_idx</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                    <span class="n">neg_idx</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                    <span class="n">positive_features</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                    <span class="n">negative_features</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="n">Xuij</span><span class="p">,</span> <span class="p">(</span><span class="n">gamma_u</span><span class="p">,</span> <span class="n">theta_u</span><span class="p">),</span> <span class="p">(</span><span class="n">beta_i_pos</span><span class="p">,</span> <span class="n">beta_i_neg</span><span class="p">),</span> <span class="p">(</span><span class="n">gamma_i_pos</span><span class="p">,</span> <span class="n">gamma_i_neg</span><span class="p">)</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">model_input</span><span class="p">)</span>
                <span class="n">loss</span> <span class="o">=</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_loss</span><span class="p">(</span><span class="n">Xuij</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

                <span class="n">reg</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">_l2_loss</span><span class="p">(</span><span class="n">gamma_u</span><span class="p">,</span> <span class="n">gamma_i_pos</span><span class="p">,</span> <span class="n">gamma_i_neg</span><span class="p">,</span> <span class="n">theta_u</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda_w</span>
                        <span class="o">+</span> <span class="n">_l2_loss</span><span class="p">(</span><span class="n">beta_i_pos</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda_b_pos</span>
                        <span class="o">+</span> <span class="n">_l2_loss</span><span class="p">(</span><span class="n">beta_i_neg</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda_b_neg</span>
                        <span class="o">+</span> <span class="n">_l2_loss</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">E</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">beta_prime</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda_e</span>
                <span class="p">)</span>

                <span class="n">loss</span> <span class="o">=</span> <span class="n">loss</span> <span class="o">+</span> <span class="n">reg</span>
                <span class="n">train_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

                <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
                <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
                <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_dl</span><span class="p">):</span>
                    <span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="si">}</span><span class="s1">, &#39;</span>
                                         <span class="sa">f</span><span class="s1">&#39;Batch </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_dl</span><span class="p">)</span><span class="si">}</span><span class="s1">, &#39;</span>
                                         <span class="sa">f</span><span class="s1">&#39;Loss: </span><span class="si">{</span><span class="n">train_loss</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">n_user_processed</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Training complete!&quot;</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Computing visual bias and theta items for faster ranking...&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="n">model</span><span class="o">.</span><span class="n">theta_items</span> <span class="o">=</span> <span class="n">items_features</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">E</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
        <span class="n">model</span><span class="o">.</span><span class="n">visual_bias</span> <span class="o">=</span> <span class="n">items_features</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">beta_prime</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
        <span class="n">model</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done!&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.fit_predict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fit_predict</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">items_directory</span><span class="p">,</span> <span class="n">user_idx_list</span><span class="p">,</span> <span class="n">methodology</span><span class="p">,</span> <span class="n">num_cpus</span><span class="p">,</span> <span class="n">save_fit</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>VBPR is not a score prediction algorithm, calling this method will raise the <code>NotPredictionAlg</code> exception!</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><span title="clayrs.recsys.content_based_algorithm.exceptions.NotPredictionAlg">NotPredictionAlg</span></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>exception raised since the VBPR algorithm is not a score prediction algorithm</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>clayrs/recsys/visual_based_algorithm/vbpr/vbpr_algorithm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fit_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_set</span><span class="p">:</span> <span class="n">Ratings</span><span class="p">,</span> <span class="n">test_set</span><span class="p">:</span> <span class="n">Ratings</span><span class="p">,</span> <span class="n">items_directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user_idx_list</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
                <span class="n">methodology</span><span class="p">:</span> <span class="n">Methodology</span><span class="p">,</span>
                <span class="n">num_cpus</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">save_fit</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">VBPRNetwork</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    VBPR is not a score prediction algorithm, calling this method will raise the `NotPredictionAlg` exception!</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotPredictionAlg: exception raised since the VBPR algorithm is not a score prediction algorithm</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">raise</span> <span class="n">NotPredictionAlg</span><span class="p">(</span><span class="s2">&quot;VBPR is not a Score Prediction Algorithm!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.fit_rank" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fit_rank</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">items_directory</span><span class="p">,</span> <span class="n">user_idx_list</span><span class="p">,</span> <span class="n">n_recs</span><span class="p">,</span> <span class="n">methodology</span><span class="p">,</span> <span class="n">num_cpus</span><span class="p">,</span> <span class="n">save_fit</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Method used to both fit and calculate ranking for all users in <code>user_idx_list</code> parameter.
The algorithm will first be fit considering all users in the <code>user_idx_list</code> which should contain user id
mapped to their integer!</p>
<p>With the <code>save_fit</code> parameter you can specify if you need the function to return the algorithm fit (in case
you want to perform multiple calls to the <code>predict()</code> or <code>rank()</code> function). If set to True, the first value
returned by this function will be the fit algorithm and the second will be the list of uir matrices with
predictions for each user.
Otherwise, if <code>save_fit</code> is False, the first value returned by this function will be <code>None</code></p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>train_set</code></td>
          <td class="doc-param-details">
            <p><code>Ratings</code> object which contains the train set of each user</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="clayrs.content_analyzer.ratings_manager.ratings.Ratings" href="../../../../content_analyzer/ratings/ratings/#clayrs.content_analyzer.ratings_manager.Ratings">Ratings</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>test_set</code></td>
          <td class="doc-param-details">
            <p>Ratings object which represents the ground truth of the split considered</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="clayrs.content_analyzer.ratings_manager.ratings.Ratings" href="../../../../content_analyzer/ratings/ratings/#clayrs.content_analyzer.ratings_manager.Ratings">Ratings</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>items_directory</code></td>
          <td class="doc-param-details">
            <p>Path where complexly represented items are serialized by the Content Analyzer</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>user_idx_list</code></td>
          <td class="doc-param-details">
            <p>Set of user idx (int representation) for which a recommendation list must be generated.
Users should be represented with their mapped integer!</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="typing.Set" href="https://docs.python.org/3/library/typing.html#typing.Set">Set</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>n_recs</code></td>
          <td class="doc-param-details">
            <p>Number of the top items that will be present in the ranking of each user.
If <code>None</code> all candidate items will be returned for the user. Default is 10 (top-10 for each user
will be computed)</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>methodology</code></td>
          <td class="doc-param-details">
            <p><code>Methodology</code> object which governs the candidate item selection. Default is
<code>TestRatingsMethodology</code>. If None, AllItemsMethodology() will be used</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="clayrs.recsys.methodology.Methodology" href="../../../methodology/abstract_methodology/#clayrs.recsys.methodology.Methodology">Methodology</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>save_fit</code></td>
          <td class="doc-param-details">
            <p>Boolean value which let you choose if the fit algorithm should be saved and returned by this
function. If True, the first value returned by this function is the fit algorithm. Otherwise, the first
value will be None. The second value is always the list of predicted uir matrices</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>num_cpus</code></td>
          <td class="doc-param-details">
            <p>number of processors that must be reserved for the method. If set to <code>0</code>, all cpus available will
be used. Be careful though: multiprocessing in python has a substantial memory overhead!</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<span title="clayrs.recsys.visual_based_algorithm.vbpr.vbpr_network.VBPRNetwork">VBPRNetwork</span>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The first value is the fit VBPR algorithm (could be None if <code>save_fit == False</code>)</p>
          </td>
        </tr>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" title="numpy" href="https://numpy.org/doc/stable/reference/index.html#module-numpy">np</a>.<a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The second value is a list of predicted uir matrices all sorted in a decreasing order w.r.t.
the ranking scores</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>clayrs/recsys/visual_based_algorithm/vbpr/vbpr_algorithm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fit_rank</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_set</span><span class="p">:</span> <span class="n">Ratings</span><span class="p">,</span> <span class="n">test_set</span><span class="p">:</span> <span class="n">Ratings</span><span class="p">,</span> <span class="n">items_directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user_idx_list</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
             <span class="n">n_recs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">methodology</span><span class="p">:</span> <span class="n">Methodology</span><span class="p">,</span>
             <span class="n">num_cpus</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">save_fit</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">VBPRNetwork</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method used to both fit and calculate ranking for all users in `user_idx_list` parameter.</span>
<span class="sd">    The algorithm will first be fit considering all users in the `user_idx_list` which should contain user id</span>
<span class="sd">    mapped to their integer!</span>

<span class="sd">    With the `save_fit` parameter you can specify if you need the function to return the algorithm fit (in case</span>
<span class="sd">    you want to perform multiple calls to the `predict()` or `rank()` function). If set to True, the first value</span>
<span class="sd">    returned by this function will be the fit algorithm and the second will be the list of uir matrices with</span>
<span class="sd">    predictions for each user.</span>
<span class="sd">    Otherwise, if `save_fit` is False, the first value returned by this function will be `None`</span>

<span class="sd">    Args:</span>
<span class="sd">        train_set: `Ratings` object which contains the train set of each user</span>
<span class="sd">        test_set: Ratings object which represents the ground truth of the split considered</span>
<span class="sd">        items_directory: Path where complexly represented items are serialized by the Content Analyzer</span>
<span class="sd">        user_idx_list: Set of user idx (int representation) for which a recommendation list must be generated.</span>
<span class="sd">            Users should be represented with their mapped integer!</span>
<span class="sd">        n_recs: Number of the top items that will be present in the ranking of each user.</span>
<span class="sd">            If `None` all candidate items will be returned for the user. Default is 10 (top-10 for each user</span>
<span class="sd">            will be computed)</span>
<span class="sd">        methodology: `Methodology` object which governs the candidate item selection. Default is</span>
<span class="sd">            `TestRatingsMethodology`. If None, AllItemsMethodology() will be used</span>
<span class="sd">        save_fit: Boolean value which let you choose if the fit algorithm should be saved and returned by this</span>
<span class="sd">            function. If True, the first value returned by this function is the fit algorithm. Otherwise, the first</span>
<span class="sd">            value will be None. The second value is always the list of predicted uir matrices</span>
<span class="sd">        num_cpus: number of processors that must be reserved for the method. If set to `0`, all cpus available will</span>
<span class="sd">            be used. Be careful though: multiprocessing in python has a substantial memory overhead!</span>

<span class="sd">    Returns:</span>
<span class="sd">        The first value is the fit VBPR algorithm (could be None if `save_fit == False`)</span>

<span class="sd">        The second value is a list of predicted uir matrices all sorted in a decreasing order w.r.t.</span>
<span class="sd">            the ranking scores</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vbpr_fit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">items_directory</span><span class="p">,</span> <span class="n">num_cpus</span><span class="p">)</span>
    <span class="n">rank</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">vbpr_fit</span><span class="p">,</span> <span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">items_directory</span><span class="p">,</span> <span class="n">user_idx_list</span><span class="p">,</span> <span class="n">n_recs</span><span class="p">,</span> <span class="n">methodology</span><span class="p">,</span> <span class="n">num_cpus</span><span class="p">)</span>

    <span class="n">vbpr_fit</span> <span class="o">=</span> <span class="n">vbpr_fit</span> <span class="k">if</span> <span class="n">save_fit</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">vbpr_fit</span><span class="p">,</span> <span class="n">rank</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.predict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">fit_alg</span><span class="p">,</span> <span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">items_directory</span><span class="p">,</span> <span class="n">user_idx_list</span><span class="p">,</span> <span class="n">methodology</span><span class="p">,</span> <span class="n">num_cpus</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>VBPR is not a score prediction algorithm, calling this method will raise the <code>NotPredictionAlg</code> exception!</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><span title="clayrs.recsys.content_based_algorithm.exceptions.NotPredictionAlg">NotPredictionAlg</span></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>exception raised since the VBPR algorithm is not a score prediction algorithm</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>clayrs/recsys/visual_based_algorithm/vbpr/vbpr_algorithm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fit_alg</span><span class="p">:</span> <span class="n">VBPRNetwork</span><span class="p">,</span> <span class="n">train_set</span><span class="p">:</span> <span class="n">Ratings</span><span class="p">,</span> <span class="n">test_set</span><span class="p">:</span> <span class="n">Ratings</span><span class="p">,</span> <span class="n">items_directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">user_idx_list</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">methodology</span><span class="p">:</span> <span class="n">Methodology</span><span class="p">,</span>
            <span class="n">num_cpus</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    VBPR is not a score prediction algorithm, calling this method will raise the `NotPredictionAlg` exception!</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotPredictionAlg: exception raised since the VBPR algorithm is not a score prediction algorithm</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">raise</span> <span class="n">NotPredictionAlg</span><span class="p">(</span><span class="s2">&quot;VBPR is not a Score Prediction Algorithm!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="clayrs.recsys.visual_based_algorithm.vbpr.vbpr_algorithm.VBPR.rank" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rank</span><span class="p">(</span><span class="n">fit_alg</span><span class="p">,</span> <span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">items_directory</span><span class="p">,</span> <span class="n">user_idx_list</span><span class="p">,</span> <span class="n">n_recs</span><span class="p">,</span> <span class="n">methodology</span><span class="p">,</span> <span class="n">num_cpus</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Method used to calculate ranking for all users in <code>user_idx_list</code> parameter.
You must first call the <code>fit()</code> method <strong><em>before</em></strong> you can compute the ranking.
The <code>user_idx_list</code> parameter should contain users with mapped to their integer!</p>
<p>The representation of the fit VBPR algorithm is a <code>VBPRNetwork</code> object (torch module which implements the
VBPR neural network)</p>
<p>If the <code>n_recs</code> is specified, then the rank will contain the top-n items for the users.
Otherwise, the rank will contain all unrated items of the particular users.</p>
<p>Via the <code>methodology</code> parameter you can perform different candidate item selection. By default, the
<code>TestRatingsMethodology()</code> is used: so, for each user, items in its test set only will be ranked</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>fit_alg</code></td>
          <td class="doc-param-details">
            <p>a fit <code>VBPRNetwork</code> object (torch module which implements the VBPR neural network)</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="clayrs.recsys.visual_based_algorithm.vbpr.vbpr_network.VBPRNetwork">VBPRNetwork</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>train_set</code></td>
          <td class="doc-param-details">
            <p><code>Ratings</code> object which contains the train set of each user</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="clayrs.content_analyzer.ratings_manager.ratings.Ratings" href="../../../../content_analyzer/ratings/ratings/#clayrs.content_analyzer.ratings_manager.Ratings">Ratings</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>test_set</code></td>
          <td class="doc-param-details">
            <p>Ratings object which represents the ground truth of the split considered</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="clayrs.content_analyzer.ratings_manager.ratings.Ratings" href="../../../../content_analyzer/ratings/ratings/#clayrs.content_analyzer.ratings_manager.Ratings">Ratings</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>items_directory</code></td>
          <td class="doc-param-details">
            <p>Path where complexly represented items are serialized by the Content Analyzer</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>user_idx_list</code></td>
          <td class="doc-param-details">
            <p>Set of user idx (int representation) for which a recommendation list must be generated.
Users should be represented with their mapped integer!</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="typing.Set" href="https://docs.python.org/3/library/typing.html#typing.Set">Set</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>n_recs</code></td>
          <td class="doc-param-details">
            <p>Number of the top items that will be present in the ranking of each user.
If <code>None</code> all candidate items will be returned for the user. Default is 10 (top-10 for each user
will be computed)</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>methodology</code></td>
          <td class="doc-param-details">
            <p><code>Methodology</code> object which governs the candidate item selection. Default is
<code>TestRatingsMethodology</code>. If None, AllItemsMethodology() will be used</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="clayrs.recsys.methodology.Methodology" href="../../../methodology/abstract_methodology/#clayrs.recsys.methodology.Methodology">Methodology</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>num_cpus</code></td>
          <td class="doc-param-details">
            <p>number of processors that must be reserved for the method. If set to <code>0</code>, all cpus available will
be used. Be careful though: multiprocessing in python has a substantial memory overhead!</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" title="numpy" href="https://numpy.org/doc/stable/reference/index.html#module-numpy">np</a>.<a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of uir matrices for each user, where each uir contains predicted interactions between users and unseen
items sorted in a descending way w.r.t. the third dimension which is the ranked score</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>clayrs/recsys/visual_based_algorithm/vbpr/vbpr_algorithm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rank</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fit_alg</span><span class="p">:</span> <span class="n">VBPRNetwork</span><span class="p">,</span> <span class="n">train_set</span><span class="p">:</span> <span class="n">Ratings</span><span class="p">,</span> <span class="n">test_set</span><span class="p">:</span> <span class="n">Ratings</span><span class="p">,</span> <span class="n">items_directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">user_idx_list</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">n_recs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">methodology</span><span class="p">:</span> <span class="n">Methodology</span><span class="p">,</span>
         <span class="n">num_cpus</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method used to calculate ranking for all users in `user_idx_list` parameter.</span>
<span class="sd">    You must first call the `fit()` method ***before*** you can compute the ranking.</span>
<span class="sd">    The `user_idx_list` parameter should contain users with mapped to their integer!</span>

<span class="sd">    The representation of the fit VBPR algorithm is a `VBPRNetwork` object (torch module which implements the</span>
<span class="sd">    VBPR neural network)</span>

<span class="sd">    If the `n_recs` is specified, then the rank will contain the top-n items for the users.</span>
<span class="sd">    Otherwise, the rank will contain all unrated items of the particular users.</span>

<span class="sd">    Via the `methodology` parameter you can perform different candidate item selection. By default, the</span>
<span class="sd">    `TestRatingsMethodology()` is used: so, for each user, items in its test set only will be ranked</span>

<span class="sd">    Args:</span>
<span class="sd">        fit_alg: a fit `VBPRNetwork` object (torch module which implements the VBPR neural network)</span>
<span class="sd">        train_set: `Ratings` object which contains the train set of each user</span>
<span class="sd">        test_set: Ratings object which represents the ground truth of the split considered</span>
<span class="sd">        items_directory: Path where complexly represented items are serialized by the Content Analyzer</span>
<span class="sd">        user_idx_list: Set of user idx (int representation) for which a recommendation list must be generated.</span>
<span class="sd">            Users should be represented with their mapped integer!</span>
<span class="sd">        n_recs: Number of the top items that will be present in the ranking of each user.</span>
<span class="sd">            If `None` all candidate items will be returned for the user. Default is 10 (top-10 for each user</span>
<span class="sd">            will be computed)</span>
<span class="sd">        methodology: `Methodology` object which governs the candidate item selection. Default is</span>
<span class="sd">            `TestRatingsMethodology`. If None, AllItemsMethodology() will be used</span>
<span class="sd">        num_cpus: number of processors that must be reserved for the method. If set to `0`, all cpus available will</span>
<span class="sd">            be used. Be careful though: multiprocessing in python has a substantial memory overhead!</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of uir matrices for each user, where each uir contains predicted interactions between users and unseen</span>
<span class="sd">            items sorted in a descending way w.r.t. the third dimension which is the ranked score</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">compute_single_rank</span><span class="p">(</span><span class="n">user_idx</span><span class="p">):</span>
        <span class="n">filter_list</span> <span class="o">=</span> <span class="n">methodology</span><span class="o">.</span><span class="n">filter_single</span><span class="p">(</span><span class="n">user_idx</span><span class="p">,</span> <span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">)</span>
        <span class="n">user_rank</span> <span class="o">=</span> <span class="n">fit_alg</span><span class="o">.</span><span class="n">return_scores</span><span class="p">(</span><span class="n">user_idx</span><span class="p">,</span> <span class="n">filter_list</span><span class="p">)</span>
        <span class="n">user_uir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span>
            <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">user_rank</span><span class="p">),</span> <span class="n">user_idx</span><span class="p">),</span>
            <span class="n">filter_list</span><span class="p">,</span>
            <span class="n">user_rank</span>
        <span class="p">))</span><span class="o">.</span><span class="n">T</span>
        <span class="c1"># items are not sorted so we sort them (to have descending order, we invert the values of the user uir</span>
        <span class="c1"># score column</span>
        <span class="n">sorted_user_uir</span> <span class="o">=</span> <span class="n">user_uir</span><span class="p">[(</span><span class="o">-</span><span class="n">user_uir</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>
        <span class="n">sorted_user_uir</span> <span class="o">=</span> <span class="n">sorted_user_uir</span><span class="p">[:</span><span class="n">n_recs</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">user_idx</span><span class="p">,</span> <span class="n">sorted_user_uir</span>

    <span class="n">fit_alg</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

    <span class="n">methodology</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">)</span>

    <span class="n">uir_rank_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="n">get_iterator_parallel</span><span class="p">(</span><span class="n">num_cpus</span><span class="p">,</span>
                               <span class="n">compute_single_rank</span><span class="p">,</span> <span class="n">user_idx_list</span><span class="p">,</span>
                               <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">user_idx_list</span><span class="p">))</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">user_idx</span><span class="p">,</span> <span class="n">user_rank</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
            <span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Computing rank for user </span><span class="si">{</span><span class="n">user_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">uir_rank_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">user_rank</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">uir_rank_list</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Documentation made by Antonio Silletti
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/swapUniba" target="_blank" rel="noopener" title="Swap Uniba on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.tooltips", "navigation.tabs", "navigation.top", "navigation.sections", "content.code.annotate"], "search": "../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.2a6f1dda.min.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>